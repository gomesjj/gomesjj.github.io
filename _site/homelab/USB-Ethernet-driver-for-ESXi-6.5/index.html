

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="DEV | TTY Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">DEV | TTY</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/year-archive/">Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/categories/">Categories</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tags/">Tags</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/about/">About</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    




  
    





<nav class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="http://localhost:4000homelab" itemprop="item"><span itemprop="name">Homelab</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">USB Ethernet driver for ESXi 6.5</li>
      
    
  </ol>
</nav>
  


<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4000/images/bio-photo.png" class="author__avatar" alt="Jose Gomes">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Jose Gomes</h3>
    <p class="author__bio">... is just another techie.</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> United Kingdom</li>
      
      
      
      
      
        <li><a href="http://twitter.com/devttyuk"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
        <li><a href="http://linkedin.com/in/jjgomes"><i class="fa fa-fw fa-linkedin-square" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="http://github.com/gomesjj"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="USB Ethernet driver for ESXi 6.5">
    <meta itemprop="description" content="ESXi 6.5 drivers for USB 3.0 Gigabit Ethernet adapters based on the ASIX ax88179_178a or the Realtek RLT8153/RTL8152 chipsets">
    <meta itemprop="datePublished" content="November 17, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">USB Ethernet driver for ESXi 6.5
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  2 minutes read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>Back in May I wrote this <a href="/homelab/Want-a-USB-Ethernet-driver-for-ESXi-You-can-have-two/">piece</a> about USB Ethernet drivers for ESXi. I have been using both Realtek and ASIX adapters to complement the single Ethernet adapter on the Intel NUCs, and they have proved to be rock solid.</p>

<p>Fast forward a few months, and as soon as ESXi 6.5 was announced people started asking if I could recompile the drivers for the new release. Finally I had some time this week to look into that. The result? A lot of wasted time downloading the 6.5 disclosure packages, setting up the environment, tweaking build scripts, etc. It turns out that compiling the drivers in the ESXi 6.0 environment I built previously worked much better, with just a single trivial change to the USB namespace.</p>

<p>The single change I had to make was to change the namespace dependencies map from this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"VMK_NAMESPACE_REQUIRED(</span><span class="se">\"</span><span class="s2">com.vmware.usb</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">9.2.3.0</span><span class="se">\"</span><span class="s2">);</span><span class="se">\</span><span class="s2">
</span><span class="se">\n</span><span class="s2">VMK_NAMESPACE_REQUIRED(</span><span class="se">\"</span><span class="s2">com.vmware.usbnet</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">9.2.3.0</span><span class="se">\"</span><span class="s2">);"</span><span class="se">\</span>
</code></pre></div></div>

<p>To this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"VMK_NAMESPACE_REQUIRED(</span><span class="se">\"</span><span class="s2">com.vmware.usb</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">10.0</span><span class="se">\"</span><span class="s2">);</span><span class="se">\</span><span class="s2">
</span><span class="se">\n</span><span class="s2">VMK_NAMESPACE_REQUIRED(</span><span class="se">\"</span><span class="s2">com.vmware.usbnet</span><span class="se">\"</span><span class="s2">, </span><span class="se">\"</span><span class="s2">9.2.3.0</span><span class="se">\"</span><span class="s2">);"</span><span class="se">\</span>
</code></pre></div></div>

<p>Note the sneak change introduced by VMware – the USB namespace is version 10.0 now…</p>

<aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> Contents</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#whats-new" id="markdown-toc-whats-new">What’s new</a></li>
  <li><a href="#tested-devices" id="markdown-toc-tested-devices">Tested devices</a>    <ul>
      <li><a href="#asix" id="markdown-toc-asix">ASIX</a></li>
      <li><a href="#realtek" id="markdown-toc-realtek">Realtek</a></li>
    </ul>
  </li>
  <li><a href="#the-drivers" id="markdown-toc-the-drivers">The drivers</a>    <ul>
      <li><a href="#asix-1" id="markdown-toc-asix-1">ASIX</a>        <ul>
          <li><a href="#esxi-65-vib" id="markdown-toc-esxi-65-vib">ESXi 6.5 VIB</a></li>
        </ul>
      </li>
      <li><a href="#realtek-1" id="markdown-toc-realtek-1">Realtek</a>        <ul>
          <li><a href="#esxi-65-vib-1" id="markdown-toc-esxi-65-vib-1">ESXi 6.5 VIB</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

  </nav>
</aside>

<h2 id="whats-new">What’s new</h2>

<p>Quite a lot! Apart from the new functionality discussed in detail by the VMware Gurus elsewhere, looking at the latest ODP packages clearly reveals VMware’s intention to move away from what they call “legacy” drivers.</p>

<p>The USB Ethernet drivers are dependent on two legacy modules (usb and usbnet); the modules are still available in ESXi 6.5, but will not load by default.</p>

<p>My first attempt at loading the USB Ethernet drivers failed miserably. It took me some time to realise that in 6.5 all legacy USB drivers (xhci, ehci-hcd, usb-uhci, usb, usb-storage, etc.) have been replaced by a single native driver called vmkusb. It serves me right for not paying attention to the various announcements…</p>

<p>Anyway, in order to get the USB Ethernet drivers to load the vmkusb module must be disabled for the legacy USB drivers to load. The details are described in the VMware Knowledge Base article <a href="https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=2147650">2147650</a>.</p>

<p>Other than the above, there are no material differences between 6.0 and 6.5 for the legacy adapters so all performance figures described on the previous article are still valid.</p>

<h2 id="tested-devices">Tested devices</h2>

<p>The following devices were tested with these drivers.</p>

<h3 id="asix">ASIX</h3>

<ul>
  <li>
    <p><a href="https://www.amazon.co.uk/gp/product/B0095EFXMC/ref=oh_aui_detailpage_o04_s00?ie=UTF8&amp;psc=1">StarTech USB 3.0 to RJ45 Ethernet LAN 10/100/100 Network Adapter</a></p>
  </li>
  <li>
    <p><a href="https://www.amazon.co.uk/gp/product/B00D8XTOD0/ref=oh_aui_detailpage_o03_s00?ie=UTF8&amp;psc=1">StarTech USB 3.0 to Dual Port Gigabit Ethernet Adapter NIC with USB Port</a></p>
  </li>
  <li>
    <p><a href="https://www.amazon.co.uk/gp/product/B00AQM8586/ref=oh_aui_detailpage_o02_s00?ie=UTF8&amp;psc=1">Plugable USB 3.0 to 10/100/1000 Gigabit Ethernet LAN Network Adapter</a></p>
  </li>
</ul>

<h3 id="realtek">Realtek</h3>

<ul>
  <li>
    <p><a href="https://www.amazon.co.uk/Anker-AK-A7611011-USB-1000Mbit-networking/dp/B00PC0P2DI?ie=UTF8&amp;*Version*=1&amp;*entries*=0">ANKER Aluminum USB 3.0 to Ethernet Adapter</a></p>
  </li>
  <li>
    <p><a href="https://www.amazon.co.uk/dp/B00NPJP33M/ref=pd_lpo_sbs_dp_ss_1?pf_rd_p=569136327&amp;pf_rd_s=lpo-top-stripe&amp;pf_rd_t=201&amp;pf_rd_i=B00DNU8Y20&amp;pf_rd_m=A3P5ROKL5A1OLE&amp;pf_rd_r=C5N2DD7H2D7AVRXM1VHP">ANKER USB 3.0 to RJ45 Gigabit Ethernet Adapter</a></p>
  </li>
  <li>
    <p><a href="https://www.amazon.co.uk/gp/product/B00YOKMKE6/ref=pe_1959711_130662621_em_1p_0_ti">TP-LINK UE300 USB 3.0 to Gigabit Ethernet Network Adapter</a></p>
  </li>
  <li>
    <p><a href="https://www.amazon.co.uk/gp/product/B010SEARPU/ref=ox_sc_act_title_1?ie=UTF8&amp;psc=1&amp;smid=A7ZMMLW05YAY7">Rankie SuperSpeed USB 3.0 to RJ45 Gigabit Ethernet Network Adapter</a></p>
  </li>
</ul>

<p>Tested by Glen Kemp</p>

<ul>
  <li><a href="https://www.amazon.co.uk/Anker®-Unibody-Ethernet-RTL8153-Chipset/dp/B00PC0J1VC/ref=sr_1_1?s=computers&amp;ie=UTF8&amp;qid=1464184877&amp;sr=1-1&amp;keywords=Anker+Unibody+3-Port+USB+3.0+and+Ethernet+Hub">Anker Unibody 3-Port USB 3.0 and Ethernet Hub</a></li>
</ul>

<p>USB 2.0 Adapter (RTL8152B Chipset)</p>

<ul>
  <li><a href="https://www.amazon.co.uk/TP-LINK-UE200-Ethernet-Foldable-Ultrabook/dp/B01GRY7RHG">TP-LINK UE200 USB 2.0 to 100 Mbps Ethernet Network Adapter</a></li>
</ul>

<p>Tested by Glen Kemp</p>

<ul>
  <li><a href="https://www.amazon.co.uk/gp/product/B00WR6A57S/ref=as_li_ss_tl?ie=UTF8&amp;psc=1&amp;linkCode=sl1&amp;tag=s0517-21&amp;linkId=5815c60c53524b534b98dcd596eab09c">Smays 3-Port OTG USB-HUB and USB2.0 RJ45 Ethernet Network Adapter</a></li>
</ul>

<h2 id="the-drivers">The drivers</h2>

<p>You can download the VIBs using the following links:</p>

<h3 id="asix-1">ASIX</h3>

<h4 id="esxi-65-vib">ESXi 6.5 VIB</h4>

<p><a href="https://bintray.com/gomesjj/VIBs/ax88179_esxi65_vib/_latestVersion"> <img src="https://api.bintray.com/packages/gomesjj/VIBs/ax88179_esxi65_vib/images/download.svg" alt="Download" /> </a></p>

<h3 id="realtek-1">Realtek</h3>

<h4 id="esxi-65-vib-1">ESXi 6.5 VIB</h4>

<p><a href="https://bintray.com/gomesjj/VIBs/r8152_esxi65_vib/_latestVersion"> <img src="https://api.bintray.com/packages/gomesjj/VIBs/r8152_esxi65_vib/images/download.svg" alt="Download" /> </a></p>

        
      </section>

      <footer class="page__meta">
        
        




        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-11-17T00:00:00+00:00">November 17, 2016</time></p>
        
      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/homelab/USB-Ethernet-driver-for-ESXi-6.5/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/homelab/USB-Ethernet-driver-for-ESXi-6.5/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/homelab/USB-Ethernet-driver-for-ESXi-6.5/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/homelab/USB-Ethernet-driver-for-ESXi-6.5/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://localhost:4000/homelab/Want-a-USB-Ethernet-driver-for-ESXi-You-can-have-two/" class="pagination--pager" title="Want a USB Ethernet driver for ESXi? You can have two.
">Previous</a>
    
    
      <a href="http://localhost:4000/homelab/The-Mini-Lab/" class="pagination--pager" title="The Mini Lab
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  
    <a href="http://localhost:4000/homelab/How-I-Built-a-Lego-Rack-for-the-Intel-NUCs/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
        <div class="archive__item-teaser">
          <img src=
            
              "http://localhost:4000/images/kitchen_teaser.png"
            
            alt="">
        </div>
      
      <h2 class="archive__item-title" itemprop="headline">How I built a Lego Rack for the Intel NUCs
</h2>
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  11 minutes read
</p>
      
      <p class="archive__item-excerpt" itemprop="description">Building a Lego Rack for the Intel NUCs, including a working front door. Lots of sweat, tears and last minute purchases from eBay…
</p>
    </article>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a href="http://localhost:4000/homelab/The-Mini-Lab/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
        <div class="archive__item-teaser">
          <img src=
            
              "http://localhost:4000/images/mini_lab_small.png"
            
            alt="">
        </div>
      
      <h2 class="archive__item-title" itemprop="headline">The Mini Lab
</h2>
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  2 minutes read
</p>
      
      <p class="archive__item-excerpt" itemprop="description">The evolution of the home lab: Intel Avoton, Intel NUC, FreeNAS, ESXi and FreeNAS
</p>
    </article>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a href="http://localhost:4000/homelab/Want-a-USB-Ethernet-driver-for-ESXi-You-can-have-two/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
        <div class="archive__item-teaser">
          <img src=
            
              "http://localhost:4000/images/usb_adapters.png"
            
            alt="">
        </div>
      
      <h2 class="archive__item-title" itemprop="headline">Want a USB Ethernet driver for ESXi? You can have two.
</h2>
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  11 minutes read
</p>
      
      <p class="archive__item-excerpt" itemprop="description">ESXi drivers for USB 3.0 Gigabit Ethernet adapters based on the ASIX ax88179_178a or the Realtek RLT8153/RTL8152 chipsets
</p>
    </article>
  </a>
</div>
        
          



<div class="grid__item">
  
    <a href="http://localhost:4000/apple/Intel_Mesh_Commander_on_Mac_OS_X/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
        <div class="archive__item-teaser">
          <img src=
            
              "http://localhost:4000/images/commander.png"
            
            alt="">
        </div>
      
      <h2 class="archive__item-title" itemprop="headline">Intel Mesh Commander on Mac OS X
</h2>
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  5 minutes read
</p>
      
      <p class="archive__item-excerpt" itemprop="description">A Mac OS X application for the management of computers with Intel AMT (Active Management Technology), supporting redirection, remote desktop, remote terminal...</p>
    </article>
  </a>
</div>
        
      </div>
    </div>
  
</div>

    <div class="page__footer">
      <footer>
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/devttyuk"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/gomesjj"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Jose Gomes. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77925543-1', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'devttyuk';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






    <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

  </body>
</html>

